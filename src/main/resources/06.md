# 6 Java内存模型基础知识
## 6.1 并发编程模型的两个关键问题
两个问题:
1. 线程间的通信: 线程之间何种机制交换信息
2. 线程间的同步: 线程如何让不同线程顺序执行
------
两种模型: Java使用共享内存并发模型
1. 消息传递并发模型: 通信:没有公共状态,发送小心 同步:天然同步
2. 共享内存并发模型: 通信:共享状态,写读公共状态进行通信 同步: 显式指定(同步代码块)

## 6.2 Java内存模型的抽象结构
### 6.2.1 运行时内存的划分
Java运行时数据区
- 共享区(所有线程共享): 方法区~堆
- 私有区(线程私有): 
  + 虚拟机栈: 局部变量(方法内声明的变量)~方法定义参数(方法传参,会复制副本)~异常处理器参数(catch中的异常e)
  + 本地方法栈
  + 程序计数器
### 6.2.2 既然堆是共享的,为什么在堆中会有内存不可见问题?
Java主内存vs本地内存:
1. 所有共享变量都存在主内存中
2. 每个线程复制了一份共享变量
3. 线程A与B通信: A把本地内存la更新到主内存中, B从主内存中读取到lb
    volatile保证共享变量可见性,synchronized保证可见性和原子性
------
JMM(Java 内存模型):
线程A<-->本地内存A(共享变量的副本)<-JMM控制->主内存(共享变量)
线程B<-->本地内存B(共享变量的副本)<-JMM控制->主内存(共享变量)
### 6.2.3 JMM与Java内存区域划分的区别与联系
JMM VS Java内存区域: 实际是同一个事物的不同角度
- 区别: JMM是抽象的,围绕原子性~有序性和可见性; Java内存区域是实际的
- 联系: JMM的主内存是共享数据区域,包括堆和方法区; JMM本地内存是私有的,包括程序计数器~本地方法栈~虚拟机栈